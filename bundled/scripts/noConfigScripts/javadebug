#!/bin/bash
# Java No-Config Debug Wrapper Script for Unix/Linux/macOS
# This script intercepts java commands and automatically enables JDWP debugging

# Export the endpoint file path for JDWP port communication
export JDWP_ADAPTER_ENDPOINTS=$VSCODE_JDWP_ADAPTER_ENDPOINTS

# Set JDWP options only for this javadebug invocation
# This overrides the global JAVA_TOOL_OPTIONS to avoid affecting other Java processes
export JAVA_TOOL_OPTIONS="-agentlib:jdwp=transport=dt_socket,server=y,suspend=y,address=0"

# Get the directory of this script
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Use Node.js wrapper to capture JDWP port
exec node "$SCRIPT_DIR/jdwp-wrapper.js" "$@"
